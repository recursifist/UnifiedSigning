import A from'./utils.js';import'./WebComponents/DocumentSelector.js';import'./WebComponents/DetailsForm.js';import'./WebComponents/AutoSigner.js';let _;let c='individual';let d=Array();let e=Array();var B=()=>{const C=document.createElement('div');C.token='UnifiedSigningContainer';const _b=document.getElementById('UnifiedSigningRoot');_b.appendChild(C);return C},g=(_a,D)=>{const _c=_a();_c.addEventListener('completed',_A=>{_c.hidden=!0;D(_A.detail)});_.appendChild(_c)},h=A.compose((E=>g((()=>{const aA=document.createElement('document-selector');aA.documents=d.map(x=>({title:x.title,url:x.url,selected:!0}));return aA}),E)),(onDone=>aB=>g((()=>{const aC=document.createElement('details-form');e=aB;aC.fields=d.filter(w=>aB.includes(w.title)).filter(w=>w.auto!=='none').flatMap(w=>w.fields.map(f=>({...f,title:w.title}))).flat(1).filter((x,i,self)=>i===self.findIndex(t=>t.id===x.id)).sort((a,b)=>{const aa=a.id.startsWith('-'),bb=b.id.startsWith('-');if(aa===bb)return 0;return aa?1:-1});return aC}),onDone)),(()=>aD=>g((()=>{const aE=document.createElement('auto-signer');aE.webpages=d.filter(w=>e.includes(w.title)).map(w=>({title:w.title,url:w.url}));aE.documents=e;aE.details=aD;aE.entity=c;aE.run();aE.addEventListener('retry',()=>aE.run());return aE}),()=>{}))),I=(aF=>A.onReady(async ()=>{c=aF;d=await A.loadData(aF);_=B();h()}));export default {load:I};
